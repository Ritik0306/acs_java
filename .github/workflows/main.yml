name: Build and Push
on:
  push:

jobs:
  Docker_build:
    name: Code checkout
    runs-on: ubuntu-latest
    services:
      percona:
        image: percona:5.6
        env:
          MYSQL_ROOT_PASSWORD: ci
        ports: 
          - 3306:3306
        options: --name my-percona-container
    steps:
      # - name: Get Container Name
      #   id: get-container-name
      #   run: |
      #     docker ps -a
      #     docker network ls
      #     docker inspect -f '{{range .NetworkSettings.Networks}}{{.NetworkName}}{{end}}' my-percona-container
      # - name: Create a custom network
      #   run: |
      #     docker network create my_network
      #     echo "set-env name=MY_NETWORK:=my_network"

      - name: Run Ubuntu container in the same network
        run: |
          docker run --network container:my-percona-container --entrypoint /bin/sh mysql -c "mysql -hpercona -uroot -pci"
